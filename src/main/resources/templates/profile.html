<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout">
<html xmlns:th="http://www.thymeleaf.org">


<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Responsive Admin &amp; Dashboard Template based on Bootstrap 5">
    <meta name="author" content="AdminKit">
    <meta name="keywords"
          content="adminkit, bootstrap, bootstrap 5, admin, dashboard, template, responsive, css, sass, html, theme, front-end, ui kit, web">
    <meta name="_csrf" th:content="${_csrf.token}"/>
    <meta name="_csrf_header" th:content="${_csrf.headerName}"/>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="shortcut icon" href="/img/icons/icon-48x48.png"/>

    <link rel="canonical" href="https://demo-basic.adminkit.io/pages-profile.html"/>

    <title>Profile | AdminKit Demo</title>

    <link href="/css/app.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&display=swap" rel="stylesheet">

</head>
<style>

    .sidebar-nav input,
    .sidebar-nav button,
    .sidebar-nav a {
        font-size: 14px; /* 원하는 크기로 조절 */
    }

    .sidebar-item i {
        font-size: 16px; /* 아이콘 크기 조절 */
    }

    .tooltip {
        position: absolute;
        left: 113px;
        top: 322px;
        /*padding: 10px;*/
        /*border-radius:5px;*/
        color: red;
        text-align: center;
        display: none;
    }

    .tooltip2 {
        position: absolute;
        left: 112px;
        top: 570px;
        /*padding: 10px;*/
        /*border-radius:5px;*/
        color: red;
        text-align: center;
        display: none;
    }

    .tooltip:after {
        display: inline;
        position: absolute;
        top: -30px;
        left: 30px;
        width: 0px;
        height: 0px;
    }

    .tooltip2:after {
        display: inline;
        position: absolute;
        top: -30px;
        left: 30px;
        width: 0px;
        height: 0px;
    }

    .wrap:hover .tooltip {
        display: inline;
    }

    .wrap:hover .tooltip2 {
        display: inline;
    }

    #search-suggestions {
        display: none;
        position: absolute;
        color:black;
        width: 80%;
        background-color: #fff;
        border: 1px solid #ccc;
        max-height: 150px;
        overflow-y: auto;
        margin-top: 5px;
        z-index: 1;
    }

    .suggestion {
        padding: 8px;
        cursor: pointer;
    }

    .suggestion:hover {
        background-color: #f0f0f0;
    }

</style>
<body>
<div class="wrapper">
    <nav id="sidebar" class="sidebar js-sidebar">
        <div class="sidebar-content js-simplebar">
            <a class="sidebar-brand" href="/">
                <span class="align-middle">어디까지 알아보고 오셨어요?</span>
            </a>

            <ul class="sidebar-nav">
                <li class="sidebar-item">
                    <a class="sidebar-link" href="/profile">
                        <i class="align-middle" data-feather="user"></i> <span class="align-middle">회원정보</span>
                    </a>
                </li>
            </ul>
        </div>
    </nav>

    <div class="main">
        <nav class="navbar navbar-expand navbar-light navbar-bg">
            <a class="sidebar-toggle js-sidebar-toggle">
                <i class="hamburger align-self-center"></i>
            </a>

            <div class="navbar-collapse collapse">
                <ul class="navbar-nav navbar-align">
                    <li class="nav-item dropdown">
                        <a class="nav-icon dropdown-toggle d-inline-block d-sm-none" href="#" data-bs-toggle="dropdown">
                            <i class="align-middle" data-feather="settings"></i>
                        </a>
                        <a class="nav-link dropdown-toggle d-none d-sm-inline-block" href="#" data-bs-toggle="dropdown">
                            <img src="/img/avatars/avatar.jpg" class="avatar img-fluid rounded me-1" alt="Shine-J" /> <span class="text-dark">Shine-J</span>
                        </a>
                        <div class="dropdown-menu dropdown-menu-end">
                            <a class="dropdown-item" href="/profile"><i class="align-middle me-1" data-feather="user"></i> Profile</a>
                            <a class="dropdown-item" href="#">Log out</a>
                        </div>
                    </li>
                </ul>
            </div>
        </nav>

        <main class="content">
            <div class="container-fluid p-0">

                <div class="mb-3">
                    <h1 class="h3 d-inline align-middle">회원정보</h1>

                </div>
                <div class="row">
                    <div class="col-md-4 col-xl-3">
                        <div class="card mb-3">
                            <div class="card-header">
                                <h5 class="card-title mb-0">Profile</h5>
                            </div>
                            <div class="card-body text-center position-relative">
                                <img src="/img/avatars/gieunsen.png" alt="gieunsen" class="img-fluid rounded-circle mb-2" width="120" height="120"/>
                                <h5 class="card-title mb-0">Your Image</h5>
                                <div class="text-muted mb-2">Lead Developer</div>

                                <!-- 금리 특약 예상서비스 연결 코드 추가 필요-->
                                <button class="btn btn-primary" onclick="location.href='/interestSimulation'">금리 특약 예상 서비스</button>
                            </div>



                            <form action="/updateMemberCredit" id="updateMemberCredit" th:object="${creditDTO}" method="post"> <!--신용정보 관련 form. 경로 수정필요  -->
                                <hr class="my-0"/>
                                <input type="hidden" th:name="${_csrf.parameterName }" th:value="${_csrf.token }"/>
                                <div class="card-body">
                                    <h5 class="h6 card-title" style="display:inline-block; margin-right: 5px;">신용정보</h5>
                                    <div class="wrap" style="display:inline-block;">
                                        <a href="https://www.credit.co.kr/ib20/mnu/BZWMAN00001" target="_blank"
                                           style="display:inline-block;">
                                            <img src="/img/avatars/question_471664.png" width="20" height="20">
                                        </a>
                                        <h5 class="tooltip">신용점수 보러가기</h5>
                                    </div>
                                    <div style="text-align: center;">
                                        <ul style="text-align: left; list-style: none; padding: 0;">

                                            <li>NICE 신용점수<input type="textarea" class="form-control" id="nice" name="nice" rows="1" th:placeholder="${nice}"></inpttextarea></li>
                                            <br>
                                            <li>KCB 신용점수<input type="textarea" class="form-control" id="kcb" name="kcb" rows="1" th:placeholder="${kcb}"></inputtextarea></li>
                                        </ul>
                                        <button type="button" class="btn btn-primary" onclick="registCredit()">제출</button>
                                    </div>

                                </div>
                            </form>

                            <form action="/updateMemberIncome" id="updateMemberIncome" th:object="${incomeDTO}" method="post"> <!--소득정보 관련 form. 경로 수정필요  -->
                                <hr class="my-0"/>
                                <input type="hidden" th:name="${_csrf.parameterName }" th:value="${_csrf.token }"/>
                                <div class="card-body">
                                    <div class="wrap">
                                        <h5 class="h6 card-title" style="display:inline-block; margin-right: 5px;">소득정보</h5>
                                        <a href="https://www.nts.go.kr/nts/cm/cntnts/cntntsView.do?mi=6467&cntntsId=7903"
                                           target="_blank" style="display:inline-block;">
                                            <img src="/img/avatars/question_471664.png" width="20" height="20">
                                        </a>
                                        <h5 class="tooltip2">소득점수 보러가기</h5>
                                    </div>
                                    <div style="text-align: center;">
                                        <ul style="text-align: left; list-style: none; padding: 0;">

                                            <li>작년 소득<input type="text" class="form-control validation" id="incomeLastYear" name="incomeLastYear" rows="1"
                                                            th:placeholder="${#numbers.formatInteger(incomeLastYear, 3, 'COMMA')}"></input></li>
                                            <br>
                                            <li>재작년 소득<input type="text" class="form-control validation" id="incomeYearBeforeLast" name="incomeYearBeforeLast" rows="1"
                                                             th:placeholder="${#numbers.formatInteger(incomeYearBeforeLast, 3, 'COMMA')}"></input></li>
                                            <br>

                                            <li>부채<input type="text" class="form-control validation" id="debt" name="debt" rows="1"
                                                         th:placeholder="${#numbers.formatInteger(debt, 3, 'COMMA')}"></input></li>
                                            <br>
                                            <h5 style="color:red">* 부부소득 합산 시 부채도 함께 합산됨</h5>
                                        </ul>
                                        <button class="btn btn-primary" type="button" onclick="regist()">제출</button>
                                    </div>
                                </div>
                            </form>


                            <hr class="my-0"/>
                            <div class="card-body">
                                <h5 class="h6 card-title">Else</h5>
                                <ul class="list-unstyled mb-0 d-flex justify-content-center">
                                    <li class="mb-1">
                                        <form action="/deleteMember" method="get">
                                            <button type="submit" name="del" class="btn btn-lg btn-danger">회원 탈퇴</button>
                                        </form>
                                    </li>
                                </ul>
                            </div>

                        </div>
                    </div>

                    <div class="col-md-4 col-xl-9">
                        <div class="card">
                            <div class="card-header">

                                <h5 class="card-title mb-0">My wish home</h5>
                            </div>

                            <div class="card-body h-100">

                                <div class="container">

                                    <form action="/result" method="get"> <!--주소 및 kb 시세 상세보기 form 경로 수정 필요-->
                                        <div class="row">
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <label class="form-label">주소</label>
                                                    <label class="form-label" >: <span th:text="${address}" style="width: 100%" ></span></label>
                                                </div>
                                            </div>
                                            <div class="col-md-6">
                                                <div class="form-group">
                                                    <label class="form-label"></label>
                                                    <label class="form-label">KB시세: <span th:text="${#numbers.formatInteger(housePrice, 3, 'COMMA')}" style="width: 100%" ></span></label>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- 버튼 추가 -->
                                        <div class="form-group">
                                            <button type="submit" class="btn btn-primary" style="margin-left:400px;">상세보기</button>
                                        </div>

                                    </form>

                                </div>

                                <br>
                                <br>

                                <div class="container">
                                    <div class="row">

                                        <div class="col-md-6">
                                            <div class="card">
                                                <div class="card-body h-100 d-flex align-items-center justify-content-center">
                                                    <div class="card-body text-center" style=" max-width: 100%;">
                                                        <h3 style="border-bottom: 2px solid #ccc; color: grey; overflow-wrap: break-word;">IBK 안심전세대출</h3>

                                                        <h3 style="overflow-wrap: break-word;"><span th:text="${ibkAnsimJeonseResult}"></span></h3>
                                                        <h5 th:if="${ibkAnsimJeonseAmount>=1000}" style="overflow-wrap: break-word;">대출 한도: <span th:text="${#numbers.formatInteger(ibkAnsimJeonseAmount, 3, 'COMMA')}">원</span></h5>
                                                        <h5 th:if="${ibkAnsimJeonseAmount<1000}" style="overflow-wrap: break-word;">대출 한도: <span th:text="${ibkAnsimJeonseAmount}">원</span></h5>
                                                        <h6 style="overflow-wrap: break-word;">
                                                            <ul th:each="reason: ${ibkAnsimJeonseReason}">
                                                                <li th:text="${reason}"></li>
                                                            </ul>
                                                        </h6>
                                                        <img th:if="${ibkAnsimJeonseResult == '대출 불가능'}" src="/img/avatars/crysen.png" alt="대출 불가능 이미지">
                                                        <img th:if="${ibkAnsimJeonseResult == '대출 가능'}" src="/img/avatars/happysen.png" alt="대출 가능 이미지">
                                                    </div>
                                                </div>

                                            </div>
                                        </div>

                                        <div class="col-md-6">
                                            <div class="card" style="max-width: 400px;">
                                                <div class="card-body h-100 d-flex align-items-center justify-content-center">
                                                    <div class="card-body text-center" style="width: 100%; max-width: 400px;">
                                                        <h3 style="border-bottom: 2px solid #ccc; color: grey; overflow-wrap: break-word;">IBK 전세대출</h3>
                                                        <h3 style="overflow-wrap: break-word;"><span th:text="${ibkJeonseResult}"></span></h3>
                                                        <h5 th:if="${ibkJeonseAmount<1000}" style="overflow-wrap: break-word;">대출 한도: <span th:text="${ibkJeonseAmount}">원</span></h5>
                                                        <h5 th:if="${ibkJeonseAmount>=1000}" style="overflow-wrap: break-word;">대출 한도: <span th:text="${#numbers.formatInteger(ibkJeonseAmount, 3, 'COMMA')}">원</span></h5>
                                                        <h6 style="overflow-wrap: break-word;">
                                                            <ul th:each="reason: ${ibkJeonseReason}">
                                                                <li th:text="${reason}"></li>
                                                            </ul>
                                                        </h6>
                                                        <img th:if="${ibkJeonseResult == '대출 불가능'}" src="/img/avatars/crysen.png" alt="대출 불가능 이미지">
                                                        <img th:if="${ibkJeonseResult == '대출 가능'}" src="/img/avatars/happysen.png" alt="대출 가능 이미지">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                    </div>
                                </div>

                            </div>



                        </div>
                    </div>
                </div>

            </div>
    </div>


</div>
</div>



</main>

<footer class="footer">
    <div class="container-fluid">
        <div class="row text-muted">
            <div class="col-6 text-start">
                <p class="mb-0">
                    <a class="text-muted" href="https://adminkit.io/" target="_blank"><strong>AdminKit</strong></a>
                    &copy;
                </p>
            </div>
            <div class="col-6 text-end">
                <ul class="list-inline">
                    <li class="list-inline-item">
                        <a class="text-muted" href="https://adminkit.io/" target="_blank">Support</a>
                    </li>
                    <li class="list-inline-item">
                        <a class="text-muted" href="https://adminkit.io/" target="_blank">Help Center</a>
                    </li>
                    <li class="list-inline-item">
                        <a class="text-muted" href="https://adminkit.io/" target="_blank">Privacy</a>
                    </li>
                    <li class="list-inline-item">
                        <a class="text-muted" href="https://adminkit.io/" target="_blank">Terms</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
</footer>
</div>
</div>

<script src="/js/app.js"></script>
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script>
    // 가상의 검색어 데이터 (실제로는 서버에서 가져와야 함)
    const searchSuggestions = ["JavaScript", "HTML", "CSS", "React", "Vue", "Angular"];

    const searchInput = document.getElementById('search-input');
    const searchSuggestionsContainer = document.getElementById('search-suggestions');

    // 검색어 입력 시 자동 완성 기능 활성화
    searchInput.addEventListener('input', function () {
        const inputValue = this.value.toLowerCase();

        // 검색어 추천 목록 생성
        const suggestions = searchSuggestions.filter(suggestion =>
            suggestion.toLowerCase().startsWith(inputValue)
        );

        // 검색어 추천 목록을 화면에 표시
        showSuggestions(suggestions);
    });

    // 검색어 추천 목록을 화면에 표시하는 함수
    function showSuggestions(suggestions) {
        if (suggestions.length === 0) {
            searchSuggestionsContainer.style.display = 'none';
            return;
        }

        // 검색어 추천 목록을 생성하여 화면에 표시
        searchSuggestionsContainer.innerHTML = '';
        suggestions.forEach(suggestion => {
            const suggestionElement = document.createElement('div');
            suggestionElement.classList.add('suggestion');
            suggestionElement.textContent = suggestion;
            suggestionElement.addEventListener('click', function () {
                // 검색어를 클릭하면 해당 검색어를 검색창에 채우고 추천 목록 숨김
                searchInput.value = suggestion;
                searchSuggestionsContainer.style.display = 'none';
            });
            searchSuggestionsContainer.appendChild(suggestionElement);
        });

        // 검색어 추천 목록을 보이도록 설정
        searchSuggestionsContainer.style.display = 'block';
    }

    // 화면을 클릭하면 검색어 추천 목록을 숨김
    document.addEventListener('click', function (event) {
        if (!searchSuggestionsContainer.contains(event.target) && event.target !== searchInput) {
            searchSuggestionsContainer.style.display = 'none';
        }
    });
</script>

<script>
    function registCredit(event){
        let updateMemberCredit = document.getElementById("updateMemberCredit");
        let kcb = document.getElementById("kcb");
        let nice = document.getElementById("nice");

        if(!kcb || !nice){
            alert("전부 입력해주세요");
            event.preventDefault();
        }else{
            updateMemberCredit.submit();
        }
    }
    function regist(event){
        let updateMemberIncome = document.getElementById("updateMemberIncome");
        let incomeLastYear = $('#incomeLastYear').val().trim();
        let debt = $('#debt').val().trim();
        let incomeYearBeforeLast = $('#incomeYearBeforeLast').val().trim();

        if(!updateMemberIncome || !incomeLastYear ||  !debt || !incomeYearBeforeLast ){
            alert("전부 입력해주세요");
            event.preventDefault();
        }else{
            updateMemberIncome.elements['incomeLastYear'].value =  incomeLastYear.replace(/,/g, "");
            updateMemberIncome.elements['debt'].value =  debt.replace(/,/g, "");
            updateMemberIncome.elements['incomeYearBeforeLast'].value =  incomeYearBeforeLast.replace(/,/g, "");

            updateMemberIncome.submit();
        }



    }


    $(document).ready(function(){
        $('.validation').on("input", function(e) {
            const prevValue = e.target.value === '0' ? '' : e.target.value.slice(0, -1);
            //const prevValue = e.target.value.slice(0, -1);
           const regex = /[^0-9]/g;
           const newNum = e.target.value.replace(regex, "");
           if(newNum > 10**10){
                e.target.value = prevValue
                $(this).siblings(".checkVal").html("100억 이하의 값을 입력해주세요");
                $(this).siblings(".checkVal").css("display", "block");
                $(this).siblings(".checkVal").css("color", "red");
           }else{
                e.target.value = newNum.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                $(this).siblings(".checkVal").css("display", "none");
           }
        });
});

</script>

</body>

</html>